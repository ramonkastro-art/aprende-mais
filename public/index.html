<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aprende+ | Apoio Pedag√≥gico</title>
<link href="https://fonts.googleapis.com/css2?family=Fraunces:ital,wght@0,300;0,600;0,900;1,300&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
:root{
  --bg:#f5f3ee;--surface:#ffffff;--surface2:#f0ede8;--border:#e0d9d0;
  --accent:#2563eb;--accent2:#7c3aed;--accent3:#dc2626;
  --text:#1a1814;--muted:#78716c;--card-bg:#ffffff;
  --shadow:0 2px 12px rgba(0,0,0,.07);
}
*{box-sizing:border-box;margin:0;padding:0;}
body{font-family:'DM Sans',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden;}
body::before{content:'';position:fixed;top:-200px;right:-200px;width:600px;height:600px;background:radial-gradient(circle,rgba(37,99,235,.06) 0%,transparent 70%);pointer-events:none;z-index:0;}
body::after{content:'';position:fixed;bottom:-200px;left:-100px;width:500px;height:500px;background:radial-gradient(circle,rgba(124,58,237,.05) 0%,transparent 70%);pointer-events:none;z-index:0;}
header{padding:20px 40px;display:flex;align-items:center;gap:14px;border-bottom:1px solid var(--border);position:sticky;top:0;z-index:100;background:rgba(245,243,238,.95);backdrop-filter:blur(12px);box-shadow:0 1px 0 var(--border);}
.logo-icon{width:40px;height:40px;background:linear-gradient(135deg,var(--accent),var(--accent2));border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:20px;}
.logo-text{font-family:'Fraunces',serif;font-size:26px;font-weight:900;letter-spacing:-1px;}
.logo-text span{color:var(--accent);}
.logo-sub{font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:2px;margin-top:2px;}
.main{max-width:840px;margin:0 auto;padding:48px 24px 80px;position:relative;z-index:1;}
.hero{text-align:center;margin-bottom:44px;}
.hero h1{font-family:'Fraunces',serif;font-size:clamp(28px,5vw,48px);font-weight:900;line-height:1.1;letter-spacing:-2px;margin-bottom:12px;}
.hero h1 em{font-style:italic;color:var(--accent);}
.hero p{color:var(--muted);font-size:15px;font-weight:300;max-width:520px;margin:0 auto;line-height:1.6;}
.hero-badge{display:inline-flex;align-items:center;gap:6px;padding:5px 14px;background:rgba(37,99,235,.07);border:1px solid rgba(37,99,235,.15);border-radius:20px;font-size:12px;color:var(--accent);margin-bottom:18px;font-weight:500;}

/* TABS */
.input-tabs{display:flex;border:1px solid var(--border);border-radius:14px;overflow:hidden;margin-bottom:20px;}
.tab-btn{flex:1;padding:14px;background:var(--surface2);border:none;color:var(--muted);font-family:'DM Sans',sans-serif;font-size:14px;cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center;gap:8px;}
.tab-btn:first-child{border-right:1px solid var(--border);}
.tab-btn.active{background:var(--surface);color:var(--accent);font-weight:600;}
.tab-panel{display:none;}
.tab-panel.active{display:block;}

/* FORM */
.form-card{background:var(--surface);border:1px solid var(--border);border-radius:20px;padding:36px;margin-bottom:28px;box-shadow:var(--shadow);}
.section-label{font-size:11px;text-transform:uppercase;letter-spacing:1.5px;color:var(--muted);font-weight:500;margin-bottom:14px;display:flex;align-items:center;gap:8px;}
.section-label span{background:var(--accent);color:#fff;width:22px;height:22px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;font-size:11px;flex-shrink:0;}
.form-grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px;margin-bottom:16px;}
.form-grid-2{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:16px;}
.field{display:flex;flex-direction:column;gap:7px;}
label{font-size:11px;text-transform:uppercase;letter-spacing:1.5px;color:var(--muted);font-weight:500;}
input,select,textarea{background:var(--surface2);border:1px solid var(--border);border-radius:10px;padding:12px 16px;color:var(--text);font-family:'DM Sans',sans-serif;font-size:15px;transition:border-color .2s,box-shadow .2s;outline:none;width:100%;}
input:focus,select:focus,textarea:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(37,99,235,.1);}
select option{background:#fff;}
textarea{resize:vertical;min-height:90px;line-height:1.6;}

/* UPLOAD */
.upload-zone{border:2px dashed var(--border);border-radius:16px;padding:40px 24px;text-align:center;cursor:pointer;transition:all .25s;position:relative;background:var(--surface2);}
.upload-zone:hover,.upload-zone.dragover{border-color:var(--accent);background:rgba(37,99,235,.04);}
.upload-zone input[type=file]{position:absolute;inset:0;opacity:0;cursor:pointer;width:100%;height:100%;}
.upload-icon{font-size:44px;margin-bottom:14px;display:block;}
.upload-title{font-family:'Fraunces',serif;font-size:18px;font-weight:600;margin-bottom:6px;}
.upload-sub{font-size:13px;color:var(--muted);}
.preview-img{width:100%;max-height:300px;object-fit:contain;border-radius:12px;border:1px solid var(--border);margin-top:16px;display:none;}
.preview-img.visible{display:block;}
.pdf-name{margin-top:12px;font-size:13px;color:var(--accent2);display:none;}
.remove-img{margin-top:10px;padding:7px 16px;background:rgba(220,38,38,.06);border:1px solid rgba(220,38,38,.2);border-radius:8px;color:var(--accent3);font-size:13px;cursor:pointer;font-family:'DM Sans',sans-serif;display:none;align-items:center;gap:6px;}
.remove-img.visible{display:inline-flex;}
.photo-tips{margin-top:16px;background:rgba(37,99,235,.04);border:1px solid rgba(37,99,235,.15);border-radius:12px;padding:16px 18px;}
.photo-tips-title{font-size:13px;font-weight:600;color:var(--accent);margin-bottom:12px;}
.photo-tips-grid{display:grid;grid-template-columns:1fr 1fr;gap:6px;}
.tip-item{font-size:12px;padding:5px 8px;border-radius:7px;line-height:1.4;}
.tip-ok{background:rgba(16,185,129,.07);color:#065f46;}
.tip-no{background:rgba(220,38,38,.06);color:#991b1b;}
@media(max-width:480px){.photo-tips-grid{grid-template-columns:1fr;}}

/* CHECKBOXES */
.checkbox-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(195px,1fr));gap:10px;margin-top:12px;}
.checkbox-item{display:flex;align-items:center;gap:10px;padding:10px 14px;background:var(--surface2);border:1px solid var(--border);border-radius:10px;cursor:pointer;transition:border-color .2s,background .2s;user-select:none;}
.checkbox-item:hover{border-color:var(--accent2);}
.checkbox-item.checked{border-color:var(--accent);background:rgba(37,99,235,.06);}
.checkbox-item input[type=checkbox]{display:none;}
.check-icon{width:18px;height:18px;border:2px solid var(--border);border-radius:5px;display:flex;align-items:center;justify-content:center;font-size:11px;flex-shrink:0;transition:all .2s;}
.checkbox-item.checked .check-icon{background:var(--accent);border-color:var(--accent);color:#fff;}
.check-label{font-size:13px;line-height:1.3;}

.btn-generate{width:100%;margin-top:28px;padding:16px;background:linear-gradient(135deg,#2563eb,#1d4ed8);color:#fff;font-family:'Fraunces',serif;font-size:18px;font-weight:600;border:none;border-radius:12px;cursor:pointer;transition:transform .15s,box-shadow .2s;display:flex;align-items:center;justify-content:center;gap:10px;letter-spacing:-.5px;}
.btn-generate:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(37,99,235,.25);}
.btn-generate:active{transform:translateY(0);}

/* LOADING */
.loading{display:none;text-align:center;padding:50px 20px;}
.loading.visible{display:block;}
.spinner{width:48px;height:48px;border:3px solid var(--border);border-top-color:var(--accent);border-radius:50%;animation:spin .8s linear infinite;margin:0 auto 20px;}
@keyframes spin{to{transform:rotate(360deg);}}
.loading-main{color:var(--text);font-size:15px;margin-bottom:6px;}
.loading-sub{font-size:13px;color:var(--muted);font-style:italic;}
.progress-bar-wrap{width:220px;height:4px;background:var(--border);border-radius:4px;margin:16px auto 0;}
.progress-bar{height:4px;background:var(--accent);border-radius:4px;transition:width .4s ease;}

/* RESULTS */
#results{display:none;}
#results.visible{display:block;}
.result-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;flex-wrap:wrap;gap:12px;}
.result-header h2{font-family:'Fraunces',serif;font-size:26px;font-weight:900;letter-spacing:-1px;}
.result-header h2 span{color:var(--accent);}
.result-actions{display:flex;gap:10px;flex-wrap:wrap;}
.btn-action{padding:9px 18px;border:1px solid var(--border);border-radius:10px;background:var(--surface);color:var(--text);font-family:'DM Sans',sans-serif;font-size:13px;cursor:pointer;transition:all .2s;display:flex;align-items:center;gap:7px;}
.btn-pdf:hover{border-color:var(--accent3);color:var(--accent3);}
.btn-word:hover{border-color:var(--accent2);color:var(--accent2);}
.btn-new:hover{border-color:var(--muted);}
.tags-row{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:24px;}
.ref-tag{display:inline-flex;align-items:center;gap:6px;padding:5px 12px;background:rgba(37,99,235,.07);border:1px solid rgba(37,99,235,.2);border-radius:20px;font-size:12px;color:var(--accent);}

/* MODULES */
.modules{display:flex;flex-direction:column;gap:18px;}
.module{background:var(--card-bg);border:1px solid var(--border);border-radius:16px;overflow:hidden;animation:fadeUp .4s ease forwards;opacity:0;box-shadow:var(--shadow);}
@keyframes fadeUp{from{opacity:0;transform:translateY(14px)}to{opacity:1;transform:translateY(0)}}
.module-header{display:flex;align-items:center;gap:14px;padding:18px 22px;border-bottom:1px solid var(--border);cursor:pointer;user-select:none;transition:background .2s;}
.module-header:hover{background:var(--surface2);}
.module-icon{width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0;}
.module-title{font-family:'Fraunces',serif;font-size:16px;font-weight:600;flex:1;}
.module-badge{font-size:11px;padding:3px 10px;border-radius:20px;font-weight:500;text-transform:uppercase;letter-spacing:.5px;}
.chevron{color:var(--muted);transition:transform .3s;font-size:12px;}
.module.open .chevron{transform:rotate(180deg);}
.module-body{max-height:0;overflow:hidden;transition:max-height .5s ease;}
.module.open .module-body{max-height:4000px;}
.module-content{padding:22px;font-size:14px;line-height:1.9;color:#44403c;white-space:pre-wrap;}
.module-content strong{color:var(--text);font-weight:600;}
.copy-btn{display:flex;align-items:center;gap:6px;padding:7px 14px;background:var(--surface2);border:1px solid var(--border);border-radius:8px;color:var(--muted);font-size:12px;cursor:pointer;font-family:'DM Sans',sans-serif;margin:0 22px 16px;transition:all .2s;}
.copy-btn:hover{border-color:var(--accent);color:var(--accent);background:rgba(37,99,235,.05);}
.skeleton{padding:22px;display:flex;flex-direction:column;gap:10px;}
.sk-line{height:12px;background:linear-gradient(90deg,#f0ede8 25%,#e5e1db 50%,#f0ede8 75%);background-size:200% 100%;animation:shimmer 1.2s infinite;border-radius:6px;}
.sk-line.short{width:60%;}
@keyframes shimmer{0%{background-position:200% 0}100%{background-position:-200% 0}}

.mod-atividades .module-icon{background:rgba(37,99,235,.08);}
.mod-traducao .module-icon{background:rgba(5,150,105,.08);}
.mod-traducao .module-badge{background:rgba(5,150,105,.08);color:#059669;}
.mod-atividades .module-badge{background:rgba(37,99,235,.08);color:var(--accent);}
.mod-complementar .module-icon{background:rgba(217,119,6,.08);}
.mod-complementar .module-badge{background:rgba(217,119,6,.08);color:#d97706;}

.error-box{background:rgba(220,38,38,.06);border:1px solid rgba(220,38,38,.2);border-radius:12px;padding:20px;color:#dc2626;font-size:14px;line-height:1.6;display:none;margin-bottom:20px;}
.error-box.visible{display:block;}
.toast{position:fixed;bottom:28px;right:28px;background:#fff;border:1px solid rgba(37,99,235,.3);border-radius:12px;padding:12px 20px;font-size:14px;color:var(--accent);z-index:999;display:none;box-shadow:0 8px 30px rgba(0,0,0,.12);}
.toast.visible{display:flex;align-items:center;gap:10px;animation:fadeUp .3s ease;}

/* ‚îÄ‚îÄ Tablet ‚îÄ‚îÄ */
@media(max-width:768px){
  .main{padding:36px 20px 80px;}
  .result-actions{gap:8px;}
  .btn-action{padding:8px 14px;font-size:12px;}
}

/* ‚îÄ‚îÄ Mobile ‚îÄ‚îÄ */
@media(max-width:600px){
  header{padding:14px 16px;}
  .logo-text{font-size:22px;}
  .logo-sub{display:none;}
  .main{padding:24px 14px 80px;}
  .hero{margin-bottom:28px;}
  .hero p{font-size:14px;}
  .form-card{padding:20px 16px;border-radius:16px;}
  .form-grid,.form-grid-2{grid-template-columns:1fr;}
  .tab-btn{font-size:13px;padding:12px 8px;gap:5px;}
  .upload-zone{padding:28px 16px;}
  .upload-icon{font-size:36px;margin-bottom:10px;}
  .upload-title{font-size:16px;}
  .checkbox-grid{grid-template-columns:1fr;}
  .checkbox-item{padding:12px 14px;}
  .btn-generate{font-size:16px;padding:14px;}
  .result-header{flex-direction:column;align-items:flex-start;gap:14px;}
  .result-header h2{font-size:22px;}
  .result-actions{width:100%;display:grid;grid-template-columns:1fr 1fr;gap:8px;}
  .btn-action{justify-content:center;font-size:12px;padding:10px 8px;}
  .btn-new{grid-column:1/-1;}
  .module-header{padding:14px 16px;gap:10px;}
  .module-title{font-size:14px;}
  .module-badge{display:none;}
  .module-content{padding:16px;font-size:13px;}
  .copy-btn{margin:0 16px 14px;}
  .ref-tag{font-size:11px;padding:5px 10px;}
  .toast{left:16px;right:16px;bottom:20px;justify-content:center;text-align:center;}
  .loading-main{font-size:14px;}
}

footer{text-align:center;padding:24px;font-size:12px;color:var(--border);letter-spacing:.5px;}
@media(hover:none){
  input,select,textarea{font-size:16px;}
  .tab-btn,.checkbox-item,.btn-generate,.btn-action{-webkit-tap-highlight-color:transparent;}
}
</style>
</head>
<body>

<header>
  <div class="logo-icon">üìö</div>
  <div>
    <div class="logo-text">Aprende<span>+</span></div>
    <div class="logo-sub">Apoio Pedag√≥gico ‚Äî Vacaria RS</div>
  </div>
</header>

<div class="main">
  <div class="hero">
    <div class="hero-badge">üè´ Rede Municipal de Vacaria ¬∑ 6¬∫ ao 9¬∫ ano</div>
    <h1>Material complementar<br><em>para o Aprende Brasil</em></h1>
    <p>Informe o componente curricular, o ano, o volume e a p√°gina do livro ‚Äî a IA gera atividades pedag√≥gicas e material complementar espec√≠ficos para aquele conte√∫do.</p>
  </div>

  <div id="formSection">
    <div class="input-tabs">
      <button class="tab-btn active" id="tabManualBtn" onclick="switchTab('manual')">‚úèÔ∏è &nbsp;Descrever o conte√∫do</button>
      <button class="tab-btn" id="tabUploadBtn" onclick="switchTab('upload')">üì∑ &nbsp;Foto / PDF da p√°gina</button>
    </div>

    <div class="form-card">
      <div class="section-label"><span>1</span>Identifica√ß√£o do Conte√∫do</div>

      <div class="form-grid-2">
        <div class="field">
          <label>Componente Curricular</label>
          <select id="componente">
            <option value="">Selecione...</option>
            <option>L√≠ngua Portuguesa</option>
            <option>Matem√°tica</option>
            <option>Ci√™ncias</option>
            <option>Hist√≥ria</option>
            <option>Geografia</option>
            <option>L√≠ngua Inglesa</option>
            <option>Arte</option>
            <option>Educa√ß√£o F√≠sica</option>
            <option>Ensino Religioso</option>
            <option>Filosofia</option>
          </select>
        </div>
        <div class="field">
          <label>Ano / S√©rie</label>
          <select id="ano">
            <option value="">Selecione...</option>
            <option>6¬∫ ano</option>
            <option>7¬∫ ano</option>
            <option>8¬∫ ano</option>
            <option>9¬∫ ano</option>
          </select>
        </div>
      </div>

      <div class="form-grid-2">
        <div class="field">
          <label>Volume</label>
          <select id="volume">
            <option value="">Selecione...</option>
            <option>Volume 1</option>
            <option>Volume 2</option>
            <option>Volume 3</option>
            <option>Volume 4</option>
          </select>
        </div>
        <div class="field">
          <label>P√°gina(s)</label>
          <input type="text" id="pagina" placeholder="Ex: 42 ou 42-44">
        </div>
      </div>

      <!-- MANUAL -->
      <div id="tab-manual" class="tab-panel active" style="margin-top:20px">
        <div class="section-label"><span>2</span>Descreva o Conte√∫do da P√°gina</div>
        <textarea id="descricao" style="min-height:110px" placeholder="Descreva o que aparece na p√°gina: tema, exerc√≠cios, textos, conceitos, atividades... Ex: 'A p√°gina apresenta o conceito de fra√ß√µes equivalentes com exemplos visuais e 5 exerc√≠cios de simplifica√ß√£o...'"></textarea>
      </div>

      <!-- UPLOAD -->
      <div id="tab-upload" class="tab-panel" style="margin-top:20px">
        <div class="section-label"><span>2</span>Foto ou PDF da P√°gina</div>
        <div class="upload-zone" id="uploadZone">
          <input type="file" id="fileInput" accept="image/*,application/pdf" onchange="handleFile(event)">
          <span class="upload-icon">üñºÔ∏è</span>
          <div class="upload-title">Arraste aqui ou clique para selecionar</div>
          <div class="upload-sub">JPG, PNG, WEBP ou PDF &nbsp;¬∑&nbsp; m√°x. 10 MB</div>
        </div>
        <div class="photo-tips">
          <div class="photo-tips-title">üì∏ Dicas para uma boa foto</div>
          <div class="photo-tips-grid">
            <div class="tip-item tip-ok">‚úÖ P√°gina plana e aberta</div>
            <div class="tip-item tip-ok">‚úÖ Boa ilumina√ß√£o, sem sombras</div>
            <div class="tip-item tip-ok">‚úÖ Texto totalmente leg√≠vel</div>
            <div class="tip-item tip-ok">‚úÖ Foto centralizada na p√°gina</div>
            <div class="tip-item tip-no">‚ùå Foto torta ou inclinada</div>
            <div class="tip-item tip-no">‚ùå Dedo ou objeto cobrindo texto</div>
            <div class="tip-item tip-no">‚ùå Imagem desfocada ou escura</div>
            <div class="tip-item tip-no">‚ùå P√°gina parcialmente cortada</div>
          </div>
        </div>
        <img id="previewImg" class="preview-img" alt="Pr√©via">
        <div id="pdfName" class="pdf-name"></div>
        <button class="remove-img" id="removeImg" onclick="removeFile()">‚úï &nbsp;Remover arquivo</button>
        <div class="field" style="margin-top:14px">
          <label>Observa√ß√µes adicionais (opcional)</label>
          <textarea id="descExtra" placeholder="Algum foco espec√≠fico? Ex: 'Concentre nas quest√µes de interpreta√ß√£o de texto'"></textarea>
        </div>
      </div>

      <!-- RESOURCES -->
      <div style="margin-top:24px">
        <div class="section-label"><span>3</span>O que deseja gerar</div>
        <div class="checkbox-grid" id="checkboxes">
          <label class="checkbox-item checked" onclick="toggleCheck(this)">
            <input type="checkbox" value="atividades" checked>
            <div class="check-icon">‚úì</div>
            <span class="check-label">‚úèÔ∏è Atividades pedag√≥gicas</span>
          </label>
          <label class="checkbox-item checked" onclick="toggleCheck(this)">
            <input type="checkbox" value="complementar" checked>
            <div class="check-icon">‚úì</div>
            <span class="check-label">üìé Material complementar</span>
          </label>
          <label class="checkbox-item" id="checkTraducao" onclick="toggleCheck(this)" style="display:none">
            <input type="checkbox" value="traducao">
            <div class="check-icon"></div>
            <span class="check-label">üåê Traduzir conte√∫do</span>
          </label>
        </div>
      </div>

      <button class="btn-generate" onclick="generate()">‚ú® &nbsp;Gerar Materiais</button>
    </div>
  </div>

  <div class="error-box" id="errorBox"></div>

  <div class="loading" id="loading">
    <div class="spinner"></div>
    <p class="loading-main" id="loadingMain">Preparando...</p>
    <p class="loading-sub">Analisando o conte√∫do e gerando materiais espec√≠ficos para esta p√°gina ‚ú®</p>
    <div class="progress-bar-wrap"><div class="progress-bar" id="progressBar" style="width:0%"></div></div>
  </div>

  <div id="results">
    <div class="result-header">
      <h2>Materiais <span>Gerados</span></h2>
      <div class="result-actions">
        <button class="btn-action btn-pdf" onclick="exportPDF()">üìÑ Exportar PDF</button>
        <button class="btn-action btn-word" onclick="exportWord()">üìù Exportar Word</button>
        <button class="btn-action btn-new" onclick="resetForm()">‚Üê Nova consulta</button>
      </div>
    </div>
    <div class="tags-row">
      <div class="ref-tag" id="refTag"></div>
      <div class="ref-tag" id="aiBadge">‚ú¶ Usando Gemini</div>
    </div>
    <div class="modules" id="modules"></div>
  </div>
</div>

<div class="toast" id="toast"></div>

<footer>
  <p>Desenvolvido por Ramon Castro</p>
</footer>

<script>
/* ‚îÄ‚îÄ State ‚îÄ‚îÄ */
let currentMode = 'manual';
let uploadedB64 = null, uploadedMime = null;
let generatedContent = {}, currentRef = '', currentComponente = '';

const CFG = {
  atividades:  {icon:'‚úèÔ∏è', title:'Atividades Pedag√≥gicas', cls:'mod-atividades',   badge:'Atividades'},
  complementar:{icon:'üìé', title:'Material Complementar',   cls:'mod-complementar', badge:'Complementar'},
  traducao:    {icon:'üåê', title:'Tradu√ß√£o do Conte√∫do',    cls:'mod-traducao',     badge:'Tradu√ß√£o'},
};

const KEYS = ['atividades','complementar','traducao'];

/* ‚îÄ‚îÄ Mostrar/ocultar tradu√ß√£o se Ingl√™s ‚îÄ‚îÄ */
document.getElementById('componente').addEventListener('change', function() {
  const isIngles = this.value === 'L√≠ngua Inglesa';
  const checkTraducao = document.getElementById('checkTraducao');
  if (isIngles) {
    checkTraducao.style.display = 'flex';
  } else {
    checkTraducao.style.display = 'none';
    // desmarca se estava marcado
    const cb = checkTraducao.querySelector('input');
    if (cb.checked) {
      cb.checked = false;
      checkTraducao.classList.remove('checked');
      checkTraducao.querySelector('.check-icon').textContent = '';
    }
  }
});

/* ‚îÄ‚îÄ Tabs ‚îÄ‚îÄ */
function switchTab(mode) {
  currentMode = mode;
  document.getElementById('tabManualBtn').classList.toggle('active', mode==='manual');
  document.getElementById('tabUploadBtn').classList.toggle('active', mode==='upload');
  document.getElementById('tab-manual').classList.toggle('active', mode==='manual');
  document.getElementById('tab-upload').classList.toggle('active', mode==='upload');
}

/* ‚îÄ‚îÄ File Upload ‚îÄ‚îÄ */
function handleFile(e) {
  const file = e.target.files[0];
  if (!file) return;
  if (file.size > 10*1024*1024) { alert('Arquivo muito grande. M√°ximo: 10 MB.'); return; }
  const reader = new FileReader();
  reader.onload = ev => {
    uploadedB64 = ev.target.result.split(',')[1];
    uploadedMime = file.type;
    const img = document.getElementById('previewImg');
    const pn = document.getElementById('pdfName');
    if (file.type.startsWith('image/')) {
      img.src = ev.target.result; img.classList.add('visible');
      pn.style.display = 'none';
    } else {
      img.classList.remove('visible');
      pn.textContent = 'üìÑ ' + file.name; pn.style.display = 'block';
    }
    document.getElementById('removeImg').classList.add('visible');
  };
  reader.readAsDataURL(file);
}

function removeFile() {
  uploadedB64 = null; uploadedMime = null;
  document.getElementById('fileInput').value = '';
  document.getElementById('previewImg').classList.remove('visible');
  document.getElementById('removeImg').classList.remove('visible');
  document.getElementById('pdfName').style.display = 'none';
}

const zone = document.getElementById('uploadZone');
zone.addEventListener('dragover', e => { e.preventDefault(); zone.classList.add('dragover'); });
zone.addEventListener('dragleave', () => zone.classList.remove('dragover'));
zone.addEventListener('drop', e => {
  e.preventDefault(); zone.classList.remove('dragover');
  if (e.dataTransfer.files[0]) {
    document.getElementById('fileInput').files = e.dataTransfer.files;
    handleFile({target: {files: e.dataTransfer.files}});
  }
});

/* ‚îÄ‚îÄ Checkbox ‚îÄ‚îÄ */
function toggleCheck(el) {
  el.classList.toggle('checked');
  const cb = el.querySelector('input');
  cb.checked = !cb.checked;
  el.querySelector('.check-icon').textContent = cb.checked ? '‚úì' : '';
}
function getChecked() {
  return [...document.querySelectorAll('#checkboxes input')].filter(c => c.checked).map(c => c.value);
}

/* ‚îÄ‚îÄ System prompt din√¢mico por componente ‚îÄ‚îÄ */
function buildSystemPrompt(componente, ano) {
  return `Voc√™ √© um assistente pedag√≥gico s√™nior, especialista no Sistema de Ensino Aprende Brasil (Grupo Positivo) e consultor para a Rede Municipal de Ensino de Vacaria-RS. Seu foco √© o Ensino Fundamental II, componente de ${componente}, ${ano}.

PRINC√çPIOS DE RESPOSTA
‚Äî Seja sint√©tico e direto. Professores t√™m pouco tempo: cada se√ß√£o deve caber em 5 a 8 linhas no m√°ximo.
‚Äî Prefira listas curtas e exemplos concretos a par√°grafos longos.
‚Äî Quando citar um exemplo, use sempre a realidade de Vacaria-RS ou do cotidiano do aluno de 11 a 15 anos.
‚Äî Sempre inclua ao menos 2 links reais e funcionais para sites externos com recursos visuais, atividades l√∫dicas ou conte√∫do interativo relacionado ao tema da p√°gina (Khan Academy, Wordwall, Kahoot, Canva Edu, YouTube Educa√ß√£o, National Geographic, Britannica, entre outros).
‚Äî Conecte o tema da p√°gina com a BNCC Computa√ß√£o (Pensamento Computacional, Mundo Digital ou Cultura Digital) em no m√°ximo 3 linhas.
‚Äî Nunca invente conte√∫do fora do que a p√°gina prop√µe.

FORMATO DE SA√çDA
Texto puro, organizado, em portugu√™s brasileiro. Sem JSON, sem markdown, sem asteriscos, sem backticks. T√≠tulos em LETRAS MAI√öSCULAS. M√°ximo de 400 palavras por resposta.`;
}

/* ‚îÄ‚îÄ Prompts por recurso e componente ‚îÄ‚îÄ */
function buildResourcePrompt(key, componente, ano, contexto) {
  if (key === 'atividades') {
    return `${contexto}

Com base APENAS nesta p√°gina do livro de ${componente} (${ano}), gere uma resposta curta e pr√°tica com as 4 se√ß√µes abaixo. M√°ximo de 400 palavras no total.

SOBRE ESTA P√ÅGINA
Em 3 a 4 linhas: o que a p√°gina ensina e qual a habilidade da BNCC que ela desenvolve.

COMO TRABALHAR EM SALA
2 perguntas disparadoras + 1 din√¢mica r√°pida (m√°x. 20 min) baseadas diretamente no conte√∫do da p√°gina.

CONEX√ÉO COM TECNOLOGIA
Em 2 a 3 linhas: como relacionar o tema com Pensamento Computacional, Mundo Digital ou Cultura Digital. Sugira 1 ferramenta ou atividade desplugada.

ATIVIDADE COMPLEMENTAR
1 atividade pr√°tica e objetiva: nome, objetivo, passo a passo em at√© 4 etapas, tempo estimado.
Inclua 2 links reais de sites com recursos visuais ou l√∫dicos sobre o tema desta p√°gina.`;
  }

  if (key === 'traducao') {
    return `${contexto}

Com base APENAS nesta p√°gina do livro de L√≠ngua Inglesa (${ano}), gere uma resposta objetiva com as 3 se√ß√µes abaixo. M√°ximo de 350 palavras no total.

TRADU√á√ÉO
Traduza os textos e di√°logos da p√°gina de forma natural e fiel.

VOCABUL√ÅRIO-CHAVE
Liste at√© 8 palavras ou express√µes importantes da p√°gina com tradu√ß√£o e 1 exemplo curto de uso.

GRAM√ÅTICA EM FOCO
Em 3 a 5 linhas: explique a estrutura gramatical principal da p√°gina com 1 exemplo pr√°tico.
Inclua 1 link de site externo para praticar o conte√∫do (ex: Wordwall, British Council, Duolingo for Schools).`;
  }

  if (key === 'complementar') {
    return `${contexto}

Com base APENAS nesta p√°gina do livro de ${componente} (${ano}), gere material complementar curto e √∫til com as 4 se√ß√µes abaixo. M√°ximo de 400 palavras no total.

APROFUNDAMENTO R√ÅPIDO
Em 4 a 5 linhas: explique o conceito da p√°gina de forma mais ampla, com 1 exemplo do cotidiano de Vacaria-RS.

CURIOSIDADE OU CONTEXTO
1 fato interessante, dado atual ou conex√£o com o mundo real relacionado ao tema desta p√°gina.

CONEX√ÉO COM TECNOLOGIA
Em 2 a 3 linhas: como o tema da p√°gina se conecta com Pensamento Computacional, Mundo Digital ou Cultura Digital.

RECURSOS EXTERNOS
Indique 2 a 3 links reais de sites com imagens, v√≠deos, jogos ou atividades l√∫dicas sobre o tema desta p√°gina (Khan Academy, National Geographic, Britannica, YouTube Educa√ß√£o, Canva Edu, Wordwall, etc.).`;
  }
}

/* ‚îÄ‚îÄ API call ‚îÄ‚îÄ */
let activeAI = 'gemini';

async function callAPI(userContent, systemPrompt) {
  const res = await fetch('/api/generate', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({ userContent, systemPrompt })
  });
  const data = await res.json();
  if (data.error) throw new Error(data.error);
  if (data.provider && data.provider !== activeAI) {
    activeAI = data.provider;
    updateAIBadge(data.provider);
  }
  return data.text;
}

function updateAIBadge(ai) {
  const badge = document.getElementById('aiBadge');
  if (!badge) return;
  if (ai === 'openai') {
    badge.textContent = '‚ú¶ Usando OpenAI (backup)';
    badge.style.background = 'rgba(16,163,127,.08)';
    badge.style.borderColor = 'rgba(16,163,127,.25)';
    badge.style.color = '#059669';
  } else {
    badge.textContent = '‚ú¶ Usando Gemini';
    badge.style.background = 'rgba(66,133,244,.08)';
    badge.style.borderColor = 'rgba(66,133,244,.25)';
    badge.style.color = '#2563eb';
  }
}

/* ‚îÄ‚îÄ Generate ‚îÄ‚îÄ */
async function generate() {
  const componente = document.getElementById('componente').value;
  const ano        = document.getElementById('ano').value;
  const volume     = document.getElementById('volume').value;
  const pagina     = document.getElementById('pagina').value;
  const recursos   = getChecked();

  if (!componente) { alert('Por favor, selecione o componente curricular.'); return; }
  if (!ano)        { alert('Por favor, selecione o ano/s√©rie.'); return; }
  if (currentMode === 'manual' && !document.getElementById('descricao').value.trim()) {
    alert('Por favor, descreva o conte√∫do da p√°gina.'); return;
  }
  if (currentMode === 'upload' && !uploadedB64) {
    alert('Por favor, fa√ßa upload de uma foto ou PDF da p√°gina.'); return;
  }
  if (recursos.length === 0) { alert('Selecione pelo menos um recurso.'); return; }

  // Reset UI
  document.getElementById('formSection').style.display = 'none';
  document.getElementById('errorBox').classList.remove('visible');
  document.getElementById('modules').innerHTML = '';
  document.getElementById('results').classList.remove('visible');
  document.getElementById('loading').classList.add('visible');
  generatedContent = {};
  activeAI = 'gemini';
  updateAIBadge('gemini');

  currentComponente = componente;
  currentRef = `${componente} ¬∑ ${ano} ¬∑ ${volume || 'Vol. ?'} ¬∑ P√°g. ${pagina || '?'}`;
  document.getElementById('refTag').textContent = 'üìñ ' + currentRef;

  const descricao = currentMode === 'manual'
    ? document.getElementById('descricao').value
    : (document.getElementById('descExtra').value || '');

  const contexto = `Livro Aprende Brasil ‚Äî ${componente}, ${ano}, ${volume || '?'}, p√°gina ${pagina || '?'}.${descricao ? ' Descri√ß√£o do professor: ' + descricao : ' Analise o conte√∫do visual da imagem/PDF fornecido.'}`;

  const systemPrompt = buildSystemPrompt(componente, ano);

  const buildContent = (prompt) => {
    if (currentMode === 'upload') {
      return [
        { type: uploadedMime === 'application/pdf' ? 'document' : 'image',
          source: {type: 'base64', media_type: uploadedMime, data: uploadedB64} },
        { type: 'text', text: prompt }
      ];
    }
    return prompt;
  };

  const loadingMain = document.getElementById('loadingMain');
  const progressBar = document.getElementById('progressBar');

  try {
    document.getElementById('results').classList.add('visible');

    for (let i = 0; i < recursos.length; i++) {
      const key = recursos[i];
      const c = CFG[key];
      loadingMain.textContent = `Gerando ${i + 1} de ${recursos.length}: ${c.title}...`;
      progressBar.style.width = ((i / recursos.length) * 100) + '%';

      appendSkeleton(key);

      const prompt = buildResourcePrompt(key, componente, ano, contexto);
      const text = await callAPI(buildContent(prompt), systemPrompt);
      generatedContent[key] = text;
      replaceSkeleton(key, text);
    }

    progressBar.style.width = '100%';
    setTimeout(() => document.getElementById('loading').classList.remove('visible'), 400);

  } catch (err) {
    document.getElementById('loading').classList.remove('visible');
    if (Object.keys(generatedContent).length === 0) {
      document.getElementById('formSection').style.display = 'block';
      document.getElementById('results').classList.remove('visible');
    }
    const eb = document.getElementById('errorBox');
    eb.classList.add('visible');
    eb.innerHTML = '‚ö†Ô∏è Erro: ' + err.message + '<br><small>Os recursos j√° gerados foram mantidos. Tente novamente para continuar.</small>';
  }
}

/* ‚îÄ‚îÄ Skeleton ‚îÄ‚îÄ */
function appendSkeleton(key) {
  const c = CFG[key];
  const div = document.createElement('div');
  div.className = `module ${c.cls} open`;
  div.id = 'mod-' + key;
  div.innerHTML = `
    <div class="module-header">
      <div class="module-icon">${c.icon}</div>
      <div class="module-title">${c.title}</div>
      <span class="module-badge">${c.badge}</span>
      <span style="font-size:12px;color:var(--accent2)">Gerando...</span>
    </div>
    <div class="module-body" style="max-height:4000px">
      <div class="skeleton">
        <div class="sk-line"></div><div class="sk-line short"></div>
        <div class="sk-line"></div><div class="sk-line"></div>
        <div class="sk-line short"></div>
      </div>
    </div>`;
  document.getElementById('modules').appendChild(div);
  div.scrollIntoView({behavior:'smooth', block:'nearest'});
}

function replaceSkeleton(key, text) {
  const c = CFG[key];
  const div = document.getElementById('mod-' + key);
  if (!div) return;
  div.innerHTML = `
    <div class="module-header" onclick="this.parentElement.classList.toggle('open')">
      <div class="module-icon">${c.icon}</div>
      <div class="module-title">${c.title}</div>
      <span class="module-badge">${c.badge}</span>
      <span class="chevron">‚ñº</span>
    </div>
    <div class="module-body">
      <div class="module-content">${escHtml(text)}</div>
      <button class="copy-btn" onclick="copyText(this, this.dataset.text)" data-text="${escAttr(text)}">üìã Copiar texto</button>
    </div>`;
  div.classList.add('open');
}

function escHtml(t) {
  return t.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}
function escAttr(t) {
  return t.replace(/&/g,'&amp;').replace(/"/g,'&quot;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}

function copyText(btn, text) {
  navigator.clipboard.writeText(text).then(() => {
    btn.textContent = '‚úÖ Copiado!';
    setTimeout(() => btn.innerHTML = 'üìã Copiar texto', 2000);
  });
}

function resetForm() {
  document.getElementById('results').classList.remove('visible');
  document.getElementById('formSection').style.display = 'block';
  document.getElementById('modules').innerHTML = '';
  document.getElementById('errorBox').classList.remove('visible');
  generatedContent = {};
}

/* ‚îÄ‚îÄ Logo SMED em base64 ‚îÄ‚îÄ */
const SMED_LOGO = 'data:image/png;base64,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';

/* ‚îÄ‚îÄ Export PDF ‚îÄ‚îÄ */
function exportPDF() {
  const {jsPDF} = window.jspdf;
  const doc = new jsPDF({unit:'mm', format:'a4'});
  const W=210, M=20, cW=W-M*2;
  let y = 32;

  // Remove emojis que corrompem o PDF
  const sanitize = (text) => text
    .replace(/[\u{1F000}-\u{1FFFF}]/gu, '')
    .replace(/[\u2600-\u27BF]/gu, '')
    .replace(/‚úÖ|‚ùå|üìö|‚úèÔ∏è|üìé|üåê|üìã|üìÑ|üì∑|‚ú®|‚ö†Ô∏è|‚Üê/gu, '')
    .trim();

  const write = (text, size, bold, rgb, lineH) => {
    doc.setFontSize(size);
    doc.setFont('helvetica', bold ? 'bold' : 'normal');
    doc.setTextColor(...(rgb || [40,50,70]));
    const lines = doc.splitTextToSize(sanitize(String(text)), cW);
    const lh = lineH || size * 0.45;
    lines.forEach(l => {
      if (y > 276) {
        doc.addPage();
        y = 24;
        // Faixa azul no topo de cada p√°gina
        doc.setFillColor(37,99,235);
        doc.rect(0,0,W,12,'F');
        doc.setFontSize(7); doc.setFont('helvetica','normal'); doc.setTextColor(255,255,255);
        doc.text('APRENDE+ ¬∑ Apoio Pedagogico ‚Äî Rede Municipal de Vacaria-RS', M, 7);
        try { doc.addImage(SMED_LOGO, 'PNG', W-16, 0, 12, 12); } catch(e) {}
        y = 22;
      }
      doc.text(l, M, y);
      y += lh;
    });
    y += 2;
  };

  // Cabe√ßalho
  doc.setFillColor(37,99,235);
  doc.rect(0,0,W,22,'F');
  doc.setFillColor(255,200,50);
  doc.rect(0,0,5,22,'F');
  doc.setFontSize(14); doc.setFont('helvetica','bold'); doc.setTextColor(255,255,255);
  doc.text('APRENDE+', 10, 9);
  doc.setFontSize(8); doc.setFont('helvetica','normal');
  doc.text('Apoio Pedagogico ‚Äî Rede Municipal de Ensino de Vacaria-RS', 10, 16);
  // Logo SMED no canto superior direito
  try { doc.addImage(SMED_LOGO, 'PNG', W-28, 1, 20, 20); } catch(e) {}

  y = 34;

  // T√≠tulo e refer√™ncia
  write('Materiais Pedagogicos Complementares', 16, true, [20,40,100], 7.5);
  write(sanitize(currentRef), 11, false, [70,85,130], 6);
  write('Gerado em ' + new Date().toLocaleDateString('pt-BR'), 9, false, [150,155,165], 5);
  y += 5;

  // Linha divis√≥ria
  doc.setDrawColor(220,225,240);
  doc.setLineWidth(0.4);
  doc.line(M, y, W-M, y);
  y += 8;

  KEYS.forEach(key => {
    if (!generatedContent[key]) return;
    const c = CFG[key];

    if (y > 255) { doc.addPage(); y = 24; }

    // Caixa do t√≠tulo da se√ß√£o
    doc.setFillColor(240,244,255);
    doc.roundedRect(M-2, y-5, cW+4, 10, 2, 2, 'F');
    doc.setDrawColor(180,195,235);
    doc.setLineWidth(0.3);
    doc.roundedRect(M-2, y-5, cW+4, 10, 2, 2, 'S');

    write(c.title.toUpperCase(), 11, true, [25,55,140], 6);
    y += 2;

    write(generatedContent[key], 11, false, [45,50,65], 6);
    y += 6;

    // Linha separadora entre se√ß√µes
    doc.setDrawColor(230,233,242);
    doc.setLineWidth(0.3);
    doc.line(M, y-2, W-M, y-2);
    y += 4;
  });

  // Rodap√© em todas as p√°ginas
  const pg = doc.getNumberOfPages();
  for (let i=1; i<=pg; i++) {
    doc.setPage(i);
    doc.setFillColor(248,249,252);
    doc.rect(0,284,W,13,'F');
    doc.setDrawColor(210,215,230);
    doc.setLineWidth(0.3);
    doc.line(0,284,W,284);
    doc.setFontSize(8); doc.setFont('helvetica','normal'); doc.setTextColor(140,148,170);
    doc.text('Aprende+ ¬∑ Rede Municipal de Vacaria-RS ¬∑ ' + new Date().toLocaleDateString('pt-BR'), M, 291);
    doc.text(i + ' / ' + pg, W-M, 291, {align:'right'});
  }

  doc.save('AprendeMais_' + sanitize(currentRef).replace(/[^a-zA-Z0-9]/g,'_') + '.pdf');
  showToast('PDF exportado com sucesso!');
}

/* ‚îÄ‚îÄ Export Word ‚îÄ‚îÄ */
function exportWord() {
  let sections = '';
  KEYS.forEach(key => {
    if (!generatedContent[key]) return;
    const c = CFG[key];
    const html = escHtml(generatedContent[key]).replace(/\n/g, '<br>');
    sections += `<div style="margin-bottom:28px;page-break-inside:avoid">
      <h2 style="color:#1d4ed8;border-bottom:2px solid #dbeafe;padding-bottom:8px;margin-bottom:12px">${c.icon} ${c.title}</h2>
      <p style="line-height:1.8">${html}</p></div>`;
  });

  const html = `<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40">
<head><meta charset="UTF-8">
<style>body{font-family:Calibri,Arial,sans-serif;font-size:11pt;color:#1c1917;margin:50px 60px;}h1{font-size:18pt;color:#1d4ed8;}h2{font-size:13pt;}p{line-height:1.8;margin-bottom:10px;}.meta{color:#6b7280;font-size:10pt;}hr{border:none;border-top:2px solid #dbeafe;margin:20px 0;}</style>
</head><body>
<h1>Materiais Pedag√≥gicos Complementares ‚Äî Aprende+</h1>
<p class="meta">${currentRef}</p>
<p class="meta">Rede Municipal de Ensino de Vacaria-RS</p>
<p class="meta">Gerado em ${new Date().toLocaleDateString('pt-BR')}</p>
<hr>${sections}</body></html>`;

  const blob = new Blob(['\ufeff', html], {type:'application/msword'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = 'AprendeMais_' + currentRef.replace(/[¬∑\s]+/g,'_') + '.doc';
  a.click(); URL.revokeObjectURL(url);
  showToast('üìù Documento Word exportado!');
}

function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg; t.classList.add('visible');
  setTimeout(() => t.classList.remove('visible'), 3000);
}
</script>
</body>
</html>
